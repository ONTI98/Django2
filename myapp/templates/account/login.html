{% extends "account/base.html" %}
{% load i18n %}
{% load allauth account %}

{% block head_title %}
  {% trans "Sign In" %}
{% endblock head_title %}

{% block body %}


<div class="flex min-h-screen items-center justify-center bg-gray-50">
  <div class="w-full max-w-md bg-white border border-gray-200 rounded-xl shadow-md p-8">
    {% block content %}

      <!-- Header -->
      {% element h1 class="text-2xl font-semibold text-center text-blue-600 mb-6" %}
        {% trans "Sign In" %}
      {% endelement %}

      {% if not SOCIALACCOUNT_ONLY %}
        <!-- Sign Up Prompt -->
        {% setvar link %}<a href="{{ signup_url }}" class="font-medium text-blue-600 hover:text-blue-800">{% endsetvar %}
        {% setvar end_link %}</a>{% endsetvar %}
        {% element p class="text-sm text-gray-600 text-center mb-6" %}
          {% blocktranslate %}If you have not created an account yet, please {{ link }}sign up{{ end_link }} first.{% endblocktranslate %}
        {% endelement %}

        <!-- Login Form -->
        {% url 'account_login' as login_url %}
        {% element form form=form method="post" action=login_url tags="entrance,login"  %}
          {% slot body %}
            {% csrf_token %}
            {% if form.errors %}
              <div class="p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md">
                {{ form.non_field_errors }}
              </div>
            {% endif %}
            {% element fields form=form unlabeled=True %}
            {% endelement %}
            {{ redirect_field }}
          {% endslot %}
        

          {% slot actions %}
            {% element button type="submit" tags="prominent,login" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2.5 rounded-md transition-colors" %}
              {% trans "Sign In" %}
            {% endelement %}
          {% endslot %}
        {% endelement %}
      {% endif %}

      <!-- Alternative Login Options -->
      {% if LOGIN_BY_CODE_ENABLED or PASSKEY_LOGIN_ENABLED %}
        {% element hr class="my-6 border-gray-200" %}
        {% endelement %}
        <div class="flex flex-col gap-3">
          {% if PASSKEY_LOGIN_ENABLED %}
            {% element button type="submit" form="mfa_login" id="passkey_login" tags="prominent,login,outline,primary" class="w-full border border-blue-600 text-blue-600 hover:bg-blue-50 rounded-md py-2.5" %}
              {% trans "Sign in with a passkey" %}
            {% endelement %}
          {% endif %}
          {% if LOGIN_BY_CODE_ENABLED %}
            {% element button href=request_login_code_url tags="prominent,login,outline,primary" class="w-full border border-blue-600 text-blue-600 hover:bg-blue-50 rounded-md py-2.5" %}
              {% trans "Send me a sign-in code" %}
            {% endelement %}
          {% endif %}
        </div>
      {% endif %}

      <!-- Social Login -->
      {% if SOCIALACCOUNT_ENABLED %}
        <div class="mt-6">
          {% include "socialaccount/snippets/login.html" with page_layout="entrance" %}
        </div>
      {% endif %}

    {% endblock content %}
  </div>
</div>
{% endblock %}

{% block extra_body %}
  {{ block.super }}
  {% if PASSKEY_LOGIN_ENABLED %}
    {% include "mfa/webauthn/snippets/login_script.html" with button_id="passkey_login" %}
  {% endif %}
{% endblock %}
